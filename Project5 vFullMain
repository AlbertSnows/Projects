// Proj4.java												//								
// AJ Snow / Lab Section C / Fridays 3:30 - 5:30 			//						
// 


import java.util.*;
import java.io.*; 

public class Proj5 {
	public static void main (String[] args) throws IOException{
	String input; 
	Scanner keyboard = new Scanner(System.in); 	
	File results = new File("Results.txt"); 
	PrintWriter outputFile = new PrintWriter(results);
	File newFile; 
	String filename; 

	
	
	
	//ask the user for the text file, if not exists display an error 
	//have them enter the file name until a valid file is entered
	//boolean fileExists = false; 
		

	do { 
		
		System.out.print("Enter in the file name: "); 
		filename= keyboard.nextLine();  
		newFile = new File (filename); 
		
		
		if (newFile.exists()){
			System.out.println("File exists!"); 
		}
		else {
			System.out.println("Error! File does not exist! Try again"); 
		}
		
	  } while (!newFile.exists());   
 
	
	
	//ask how many questions were on the exam and the number of points per person
	//allows the user to create an answer key that will be used to grade the exams
	
	System.out.print("Enter how many questions were on the exam: "); 
	input = keyboard.nextLine(); 
	double numOfQuestions;
	numOfQuestions = Double.parseDouble(input); 
	
	int answerKeyLength = Integer.parseInt(input);
	int[] answerKey = new int[answerKeyLength]; 					//Declares size of integer array for the answer key
	
	System.out.print("Enter the number of points per person"); 
	input = keyboard.nextLine(); 
	//input = pointsPerPerson(); 
	int pointsPerP = Integer.parseInt(input); 		    //Declares the points per person


	//user can enter t or f or answers a-e for multiple choice. 
	int count = 0; 
	for (count = 0; count < numOfQuestions; count++){
		System.out.println("Question " + (count+1)); 
		System.out.println("Enter 't' or 'f' for true or false.");
		System.out.println("Enter letters 'a' through 'e' for multiple choice.");
		System.out.print("Enter the correct answer here: ");
		input = keyboard.nextLine();
		input = input.toLowerCase(); 
		char answer = input.charAt(0); 
		
		int correctAnswer = 0; 
		switch (answer){
		case 't': 
			correctAnswer = 1; 
			break; 
		case 'f': 
			correctAnswer = 2; 
			break; 
		case 'a': 
			correctAnswer = 1;
			break; 
		case 'b': 
			correctAnswer = 2; 
			break; 
		case 'c': 
			correctAnswer = 3;
			break; 
		case 'd': 
			correctAnswer = 4; 
			break; 
		case 'e': 
			correctAnswer = 5; 
			break; 
		default: 
			System.out.println("Error, unrecognized value entered.");
			count--; 
			break; 
		}
		
		
		System.out.println(); 
		
		//number of answers is dependent on the number of questions
		answerKey[count] = correctAnswer; 
	}
	
	

	
	
	//read in the scantron generated text file QuizScores.txt 
	//5 students
	String[] wID = new String[50];									//Used to hold the values of tests and the students wID
	int[][] studentAnswers = new int[answerKeyLength][50]; 
	int countAnswers;
	int numOfStudents = 0; 
	Scanner fileReader = new Scanner (new FileReader(filename)); 
	
	count = 0; 
	while (fileReader.hasNext()){ 		
		
		String fileLine = fileReader.nextLine(); 
		Scanner delimiter = new Scanner(fileLine);
		
		delimiter.useDelimiter(",");
		String ID = delimiter.next(); 
		wID[count] = ID; 
		//System.out.println(wID[count]); 					 	//Prints out the wID
		
		String answers = delimiter.next(); 
		//System.out.println("Students answers: " + answers); 
	
		for (countAnswers = 0; countAnswers < numOfQuestions; countAnswers++){ 	
			int number = Character.getNumericValue(answers.charAt(countAnswers)); 
			
			//System.out.println("Student's answer to this question: " + number); 
			studentAnswers[countAnswers][count] = (number); 
		
		}
numOfStudents++; 		
count++; 
delimiter.close(); 
	}	



	//grade the quizzes and display each student WID number
	//How to "grade"? Check in assignment
	//boolean isAnswerCorrect = false; 
	int index; 
	//int studentScore;
	int highScore = 0; 
	int lowScore = (answerKeyLength+1); 
	int totalCorrect = 0; 
	double percentCorrect = 0; 
	char grade = 0; 
	
	for (index = 0; index < numOfStudents; index++){
		int numberCorrect = 0; 
		
		
		System.out.print("Student ID: " + wID[index]);
		System.out.println(); 
		
		for (count = 0; count < numOfQuestions; count++){
			
			if (studentAnswers[count][index] == answerKey[count]){
				numberCorrect++; 
				totalCorrect++; 	
			}
			
			
		}
	
		//print the correct number of answers , percentage correct to one decimal
		
		System.out.print("Number correct: " + numberCorrect); 
		System.out.println(); 
		
		percentCorrect = ((numberCorrect/numOfQuestions)*100);
		
		
		System.out.printf("Percentage correct: %.1f",  percentCorrect); 
		System.out.print("%"); 
		System.out.println(); 
		double studentScore = (numberCorrect * pointsPerP); 
		System.out.print("Student's score: " + (studentScore)); 
		System.out.println(); 

		
		
		
		if (numberCorrect > highScore){
			highScore = numberCorrect;
		}
		if (numberCorrect < lowScore){
			lowScore = numberCorrect; 
		}
		
		if (percentCorrect < 60.0) { grade = 'F'; System.out.println("Grade: " + grade);}
		else if (percentCorrect < 70.0) { grade = 'D'; System.out.println("Grade: " + grade);} 
		else if (percentCorrect < 80.0) { grade = 'C'; System.out.println("Grade: " + grade);}
		else if (percentCorrect < 90.0) { grade = 'B'; System.out.println("Grade: " + grade);}
		else { grade = 'A'; System.out.println("Grade: " + grade);}
		System.out.println(); 

		//create a comma delimited text file called results.txt containing
		//only the WID, #correct, %correct, score, and grade, one student per line. 
		
		//FileWriter fw; 
		//if (results.exists()){
		//	System.out.println("Results file exists! Appending...");
		//	fw = new FileWriter("Results.txt", true); 
		//}
		//else {
		//	System.out.println("Creating new file...");
		//	fw = new FileWriter("Results.txt", false); 
		//}

		//int countLine; 
		//for (index = 0; index < numOfStudents; index++){
		outputFile.print(wID[index] + "," + numberCorrect + ","); 
		outputFile.print(percentCorrect + "," + studentScore + "," + grade); 
		outputFile.println(); 
			
		//}
		
		
	}
	System.out.println(); 

	double classAvg = (totalCorrect/(numOfStudents*numOfQuestions)*100); 
	
	//and their grade based on the percent correct
	
	if (classAvg < 60.0) { grade = 'F'; }
	else if (classAvg< 70.0) { grade = 'D'; } 
	else if (classAvg< 80.0) { grade = 'C'; }
	else if (classAvg< 90.0) { grade = 'B'; }
	else { grade = 'A'; }
	System.out.println(); 
	
	
	//display the class average on quiz to 1 decimal
	
	System.out.printf("Average : %.1f", classAvg); 
	System.out.println("% (" + grade + ")");
	System.out.println("High Score: " + (highScore*2));
	System.out.println("Low Score: " + (lowScore*2)); 
	
	System.out.println();
	System.out.println("Results.txt File created...");

	
	fileReader.close(); 
	outputFile.close(); 
	keyboard.close(); 	
	}//end main

	
	
	//public static String pointsPerPerson(){
	//String pointsPerPerson; 
	//Scanner keyboard = new Scanner(System.in); 
	//System.out.print("Enter the number of points per person: ");
	//pointsPerPerson = keyboard.nextLine(); 
	
	//keyboard.close(); 
	//return pointsPerPerson; 
	//}//end PPP method
}//end class







